<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Bayes</title>
    <!-- Inclui a biblioteca Tailwind CSS para um design moderno e responsivo -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 min-h-screen flex items-center justify-center p-4">
    <div class="bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-xl max-w-lg w-full transform transition-transform duration-300 hover:scale-105">
        <h1 class="text-3xl font-bold text-center mb-4">Calculadora do Teorema de Bayes</h1>
        <p class="text-center text-gray-600 dark:text-gray-400 mb-6">Insira os valores para calcular a probabilidade condicional.</p>

        <!-- Container para os campos de entrada -->
        <div class="space-y-4 mb-6">
            <div class="relative">
                <label for="pBa" class="block text-sm font-medium mb-1">P(B|A):</label>
                <input type="number" id="pBa" value="0.9" step="0.01" class="w-full px-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition">
            </div>
            <div class="relative">
                <label for="pA" class="block text-sm font-medium mb-1">P(A):</label>
                <input type="number" id="pA" value="0.01" step="0.01" class="w-full px-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition">
            </div>
            <div class="relative">
                <label for="pNotA" class="block text-sm font-medium mb-1">P(¬A):</label>
                <input type="number" id="pNotA" value="0.99" step="0.01" class="w-full px-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition">
            </div>
            <div class="relative">
                <label for="pNotBa" class="block text-sm font-medium mb-1">P(B|¬A):</label>
                <input type="number" id="pNotBa" value="0.05" step="0.01" class="w-full px-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition">
            </div>
        </div>

        <!-- Botão para acionar o cálculo -->
        <button id="calculateBtn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg shadow-lg transition transform duration-300 hover:scale-105">
            Calcular
        </button>

        <!-- Área para exibir o resultado -->
        <div id="result-container" class="mt-6 text-center text-lg">
            <h2 class="text-xl font-semibold mb-2">Resultado:</h2>
            <div id="result" class="text-2xl font-bold text-blue-600 dark:text-blue-400">
                <!-- O resultado será exibido aqui -->
            </div>
        </div>
    </div>

    <script>
        // Função do Teorema de Bayes, exatamente como no seu código original
        function teorema_bayes(pBa, pA, pNotA, pNotBa) {
            const pB = pA * pBa + pNotA * pNotBa;
            if (pB === 0) {
                throw new Error("Divisão por zero: a probabilidade do evento B é zero.");
            }
            return (pBa * pA) / pB;
        }

        // Obtém referências aos elementos do DOM
        const pBaInput = document.getElementById('pBa');
        const pAInput = document.getElementById('pA');
        const pNotAInput = document.getElementById('pNotA');
        const pNotBaInput = document.getElementById('pNotBa');
        const calculateBtn = document.getElementById('calculateBtn');
        const resultDiv = document.getElementById('result');

        // Adiciona um ouvinte de evento ao botão de cálculo
        calculateBtn.addEventListener('click', () => {
            try {
                // Converte os valores dos inputs para números de ponto flutuante
                const pBa = parseFloat(pBaInput.value);
                const pA = parseFloat(pAInput.value);
                const pNotA = parseFloat(pNotAInput.value);
                const pNotBa = parseFloat(pNotBaInput.value);

                // Valida se os valores são números
                if (isNaN(pBa) || isNaN(pA) || isNaN(pNotA) || isNaN(pNotBa)) {
                    resultDiv.textContent = "Erro: Por favor, insira valores numéricos.";
                    resultDiv.classList.add('text-red-500');
                    return;
                }

                // Chama a função do Teorema de Bayes com os valores do usuário
                const resultado = teorema_bayes(pBa, pA, pNotA, pNotBa);

                // Exibe o resultado formatado com 4 casas decimais
                resultDiv.textContent = resultado.toFixed(4);
                resultDiv.classList.remove('text-red-500');
            } catch (error) {
                // Trata o erro de divisão por zero ou outros erros
                resultDiv.textContent = `Erro: ${error.message}`;
                resultDiv.classList.add('text-red-500');
            }
        });

        // Define os valores padrão para a primeira carga da página
        const valoresPadrao = { pBa: 0.9, pA: 0.01, pNotA: 0.99, pNotBa: 0.05 };
        pBaInput.value = valoresPadrao.pBa;
        pAInput.value = valoresPadrao.pA;
        pNotAInput.value = valoresPadrao.pNotA;
        pNotBaInput.value = valoresPadrao.pNotBa;

        // Executa o cálculo inicial para exibir o resultado padrão
        calculateBtn.click();
    </script>

    <!-- Bloco de teste JavaScript -->
    <script>
        // Função para rodar os testes unitários da função `teorema_bayes`.
        function runTests() {
            let passed = 0;
            let failed = 0;

            console.log("Iniciando testes para a função teorema_bayes...");

            // Teste 1: Valores esperados
            try {
                const result1 = teorema_bayes(2, 3, 2, 2);
                const expected1 = 0.6;
                if (result1 === expected1) {
                    console.log(`✔️ Teste 1 (Valor Esperado): Passou!`);
                    passed++;
                } else {
                    console.error(`❌ Teste 1 (Valor Esperado): Falhou. Esperado ${expected1}, recebido ${result1}.`);
                    failed++;
                }

                const result2 = teorema_bayes(-1, 1, -1, 1);
                const expected2 = 0.5;
                if (result2 === expected2) {
                    console.log(`✔️ Teste 2 (Valor Esperado): Passou!`);
                    passed++;
                } else {
                    console.error(`❌ Teste 2 (Valor Esperado): Falhou. Esperado ${expected2}, recebido ${result2}.`);
                    failed++;
                }
            } catch (e) {
                console.error("❌ Testes de valores esperados falharam com exceção:", e.message);
                failed++;
            }

            // Teste 2: Divisão por Zero
            try {
                teorema_bayes(0, 0, 0, 0);
                console.error("❌ Teste 3 (Divisão por Zero): Falhou. A função não levantou o erro esperado.");
                failed++;
            } catch (e) {
                if (e.message.includes("Divisão por zero")) {
                    console.log("✔️ Teste 3 (Divisão por Zero): Passou! A exceção foi capturada.");
                    passed++;
                } else {
                    console.error("❌ Teste 3 (Divisão por Zero): Falhou. Levantou uma exceção inesperada.", e.message);
                    failed++;
                }
            }
            
            console.log("---");
            console.log(`Resumo: ${passed} testes passaram, ${failed} falharam.`);
            if (failed > 0) {
                console.error("Há falhas nos testes. Verifique o console para mais detalhes.");
            } else {
                console.log("Todos os testes passaram!");
            }
        }

        // Chame a função de teste quando a página estiver carregada.
        // runTests();
        console.log("Para rodar os testes, abra o console do seu navegador e chame a função runTests().");
    </script>
</body>
</html>